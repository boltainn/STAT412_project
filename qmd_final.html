<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Untitled</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="qmd_final_files/libs/clipboard/clipboard.min.js"></script>
<script src="qmd_final_files/libs/quarto-html/quarto.js"></script>
<script src="qmd_final_files/libs/quarto-html/popper.min.js"></script>
<script src="qmd_final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="qmd_final_files/libs/quarto-html/anchor.min.js"></script>
<link href="qmd_final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="qmd_final_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="qmd_final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="qmd_final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="qmd_final_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Untitled</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="brief-statement-of-the-aim-of-the-project" class="level2">
<h2 class="anchored" data-anchor-id="brief-statement-of-the-aim-of-the-project">1. Brief Statement of The Aim of The Project</h2>
<p>In this project, data is 4 different tennis singles 2013 grand slams match statistics. In the data, there are different statistics about match like foul, number of firs serve win, and others that will be explained in the next part. Aim of the project is predict the result of the tennis match by using different match statistics. Another aim is to find most effective match statistics for the win. To reach this aim, firstly, data will be cleaned and tidied for the EDA and CDA. Then, explanatory data analysis and confirmatory data analysis will be done to see how data distributed and to interpret variables effectively. Then, missing values will be handled and data manipulation and feature engineering will be done if it is necessary. Finally, for statistical modeling to predict match result cross-validation techniques will be used. And, statistical modeling will be performed and performance of statistical modeling will be investigated.</p>
</section>
<section id="source-of-the-data-variables-and-dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="source-of-the-data-variables-and-dependent-variable">2. Source of The Data, Variables and Dependent Variable</h2>
<p>Source of the data is <a href="https://archive.ics.uci.edu/dataset/300/tennis+major+tournament+match+statistics">UC Irvine Machine Learning Repository</a>. In the source of the data, there is 8 different csv file. Each one represent different tournament from 2013 (Aus Open-Men,AusOpen-Women, USOpen-men,…). Data has 4 different tournament group by gender, so we have 8 different csv file data. All of the 8 csv data has same 42 variables, so all of them are combined to 1 csv file and 2 variable added as tournament and gender. At the end, data has 44 variable. Variable descriptions can be seen on <a href="#appendix-a">APPENDİX A</a>. Dependent variable is ‘Result’. Our data have 943 match observations.</p>
</section>
<section id="data-cleaning-and-tidying" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-tidying">3. Data Cleaning and Tidying</h2>
<p>Check variables and data types for character variables and some variables that should be factor. Others are already numeric type as desired.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   943 obs. of  6 variables:
 $ Result    : int  0 1 0 1 0 0 0 1 0 1 ...
 $ Player1   : chr  "Lukas Lacko" "Leonardo Mayer" "Marcos Baghdatis" "Dmitry Tursunov" ...
 $ Player2   : chr  "Novak Djokovic" "Albert Montanes" "Denis Istomin" "Michael Russell" ...
 $ Round     : int  1 1 1 1 1 1 1 1 1 1 ...
 $ tournament: chr  "AusOpen" "AusOpen" "AusOpen" "AusOpen" ...
 $ gender    : chr  "M" "M" "M" "M" ...</code></pre>
</div>
</div>
<p>Character values, “Round” and “Result” should be a factor. And name of the variables should be all upper or lower letter. So, all names of variables changed to upper letter.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PLAYER1"    "PLAYER2"    "ROUND"      "RESULT"     "FNL.1"     
 [6] "FNL.2"      "FSP.1"      "FSW.1"      "SSP.1"      "SSW.1"     
[11] "ACE.1"      "DBF.1"      "WNR.1"      "UFE.1"      "BPC.1"     
[16] "BPW.1"      "NPA.1"      "NPW.1"      "TPW.1"      "ST1.1"     
[21] "ST2.1"      "ST3.1"      "ST4.1"      "ST5.1"      "FSP.2"     
[26] "FSW.2"      "SSP.2"      "SSW.2"      "ACE.2"      "DBF.2"     
[31] "WNR.2"      "UFE.2"      "BPC.2"      "BPW.2"      "NPA.2"     
[36] "NPW.2"      "TPW.2"      "ST1.2"      "ST2.2"      "ST3.2"     
[41] "ST4.2"      "ST5.2"      "TOURNAMENT" "GENDER"    </code></pre>
</div>
</div>
<p>Before change character values, “Round” and “Result” to factor let’s check head and tail of the data set. There is 44 variable, so visualizing the head and tail is not feasible. Therefore, just problematic variable parts of the data shown.</p>
<p>Head and tail of the PLAYER1 and PLAYER2:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lukas Lacko</td>
<td style="text-align: left;">Novak Djokovic</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leonardo Mayer</td>
<td style="text-align: left;">Albert Montanes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marcos Baghdatis</td>
<td style="text-align: left;">Denis Istomin</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">941</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: left;">K.Flipkens</td>
</tr>
<tr class="even">
<td style="text-align: left;">942</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">A.Radwanska</td>
</tr>
<tr class="odd">
<td style="text-align: left;">943</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">M.Bartoli</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As seen on the “PLAYER1” and “PLAYER2”, there is problem about how player names saved to data. In some rows player names saved as full name (first name + surname). However, in other rows, player names saved as shortened way like “M.Bartolli”. This problem fixed by convert all names shortened.</p>
<p>After fixed player names, there is 358 player on this data set.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">L.Lacko</td>
<td style="text-align: left;">N.Djokovic</td>
</tr>
<tr class="even">
<td style="text-align: left;">L.Mayer</td>
<td style="text-align: left;">A.Montanes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M.Baghdatis</td>
<td style="text-align: left;">D.Istomin</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Except player name columns, data seems well tabulated data. There is no unnecessary columns. There is 0 duplicated observations in the data set. Player names fixed too.</p>
<p>Now character values, “Round” and “Result” can be changed to factor. And finalize structure of the data is:</p>
<p>Also there is problem about BPC(Break Points Created) and BPW(Break Points Win). Logically, BPC must be greater or equal to BPW but in some rows BPC is lower than BPW like below example. This fixed by exchanging BPC values by BPW and BPW values by BPC when BPW &gt; BPC.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">BPC.1</th>
<th style="text-align: right;">BPW.1</th>
<th style="text-align: right;">BPC.2</th>
<th style="text-align: right;">BPW.2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are similar problems with NPA and NPW for Aus open and French Open tournaments, NPA should be greater or equal to NPW. This fixed by exchanging NPA values by NPW and NPW values by NPA when NPW &gt; NPA.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">NPA.1</th>
<th style="text-align: right;">NPW.1</th>
<th style="text-align: right;">NPA.2</th>
<th style="text-align: right;">NPW.2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>After fix the problem, all BPC values are greater than BPW. Same for NPA and NPW.</p>
</section>
<section id="explanatory-data-analysiseda-and-confirmatory-data-analysiscda" class="level2">
<h2 class="anchored" data-anchor-id="explanatory-data-analysiseda-and-confirmatory-data-analysiscda">4. Explanatory Data Analysis(EDA) and Confirmatory Data Analysis(CDA)</h2>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h3>
<p>Below there are frequency tables for tournament, round, result and gender. Ausopen and French open tournaments have most number of match. Also, as expected most matches played at round 1. Number of male matches are greater than female matches. Moreover, Most round 1 matches played at US open, but at the remaining round US Open matches are not much when considering other tournaments. There can be incomplete data for US Open.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">TOURNAMENT</th>
<th style="text-align: left;">ROUND</th>
<th style="text-align: left;">RESULT</th>
<th style="text-align: left;">GENDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">AusOpen :253</td>
<td style="text-align: left;">1:536</td>
<td style="text-align: left;">1:465</td>
<td style="text-align: left;">F:452</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">FrenchOpen:252</td>
<td style="text-align: left;">2:197</td>
<td style="text-align: left;">2:478</td>
<td style="text-align: left;">M:491</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">USopen :202</td>
<td style="text-align: left;">3:107</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Wimbledon :236</td>
<td style="text-align: left;">4: 55</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">5: 27</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">6: 14</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">7: 7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
<th style="text-align: right;">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AusOpen</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">FrenchOpen</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USopen</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Summary statistics for numeric variables are below. Average performances are almost equal for player 1 and player 2 statistics. Average performance of tennis players can be seen in this summary statistics.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">FSP.1</th>
<th style="text-align: left;">FSP.2</th>
<th style="text-align: left;">FSW.1</th>
<th style="text-align: left;">FSW.2</th>
<th style="text-align: left;">ACE.1</th>
<th style="text-align: left;">ACE.2</th>
<th style="text-align: left;">BPC.1</th>
<th style="text-align: left;">BPC.2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. :38.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 3.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.:57.00</td>
<td style="text-align: left;">1st Qu.:57.00</td>
<td style="text-align: left;">1st Qu.: 26.00</td>
<td style="text-align: left;">1st Qu.: 25.00</td>
<td style="text-align: left;">1st Qu.: 2.00</td>
<td style="text-align: left;">1st Qu.: 1.000</td>
<td style="text-align: left;">1st Qu.: 5.000</td>
<td style="text-align: left;">1st Qu.: 5.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :62.00</td>
<td style="text-align: left;">Median :62.00</td>
<td style="text-align: left;">Median : 37.00</td>
<td style="text-align: left;">Median : 36.00</td>
<td style="text-align: left;">Median : 4.00</td>
<td style="text-align: left;">Median : 4.000</td>
<td style="text-align: left;">Median : 9.000</td>
<td style="text-align: left;">Median : 8.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :62.26</td>
<td style="text-align: left;">Mean :61.97</td>
<td style="text-align: left;">Mean : 38.79</td>
<td style="text-align: left;">Mean : 38.69</td>
<td style="text-align: left;">Mean : 6.14</td>
<td style="text-align: left;">Mean : 5.983</td>
<td style="text-align: left;">Mean : 8.792</td>
<td style="text-align: left;">Mean : 8.648</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:67.00</td>
<td style="text-align: left;">3rd Qu.:67.00</td>
<td style="text-align: left;">3rd Qu.: 49.00</td>
<td style="text-align: left;">3rd Qu.: 48.50</td>
<td style="text-align: left;">3rd Qu.: 8.00</td>
<td style="text-align: left;">3rd Qu.: 9.000</td>
<td style="text-align: left;">3rd Qu.:12.000</td>
<td style="text-align: left;">3rd Qu.:12.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :86.00</td>
<td style="text-align: left;">Max. :93.00</td>
<td style="text-align: left;">Max. :109.00</td>
<td style="text-align: left;">Max. :132.00</td>
<td style="text-align: left;">Max. :41.00</td>
<td style="text-align: left;">Max. :39.000</td>
<td style="text-align: left;">Max. :28.000</td>
<td style="text-align: left;">Max. :26.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA’s :22</td>
<td style="text-align: left;">NA’s :22</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Also, set result summary is like below, as seen, there are a lot of NA values for ST4 and ST5 especially. This is because most of the match is not last to 5 or 4 set. It is over in 2 or 3 sets.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">ST1.1</th>
<th style="text-align: left;">ST2.1</th>
<th style="text-align: left;">ST3.1</th>
<th style="text-align: left;">ST4.1</th>
<th style="text-align: left;">ST5.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:4.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :5.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :4.801</td>
<td style="text-align: left;">Mean :4.781</td>
<td style="text-align: left;">Mean :4.728</td>
<td style="text-align: left;">Mean :4.787</td>
<td style="text-align: left;">Mean :4.651</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :9.000</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :9.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :4</td>
<td style="text-align: left;">NA’s :321</td>
<td style="text-align: left;">NA’s :722</td>
<td style="text-align: left;">NA’s :857</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="research-questions" class="level3">
<h3 class="anchored" data-anchor-id="research-questions">Research Questions</h3>
<section id="how-does-number-of-break-points-win-bpw-and-break-points-created-bpc-corralete-between-2-player-according-to-result" class="level4">
<h4 class="anchored" data-anchor-id="how-does-number-of-break-points-win-bpw-and-break-points-created-bpc-corralete-between-2-player-according-to-result">How does number of break points win (BPW) and break points created (BPC) corralete between 2 player according to result?</h4>
<p>As seen in the scatter plot, there is correlation between result and break points win. If player has more break points than opponent player, then, player that has more BPW and BPC probably win the match.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hypothesis t-test can be conduct to show avarage BPC or BPW is greater for winning player.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  BPC.1.P1win$BPC.1
W = 0.97274, p-value = 1.286e-07</code></pre>
</div>
</div>
</section>
<section id="how-does-change-distribution-of-first-serve-percentage-fsp-and-first-serve-winning-fsw-for-winning-and-losing-player" class="level4">
<h4 class="anchored" data-anchor-id="how-does-change-distribution-of-first-serve-percentage-fsp-and-first-serve-winning-fsw-for-winning-and-losing-player">How does change distribution of first serve percentage (FSP) and First serve winning (FSW) for winning and losing player?</h4>
<p>As seen on the density plot, when player win the match, player’s first serve percentage is increase. Therefore, first serve percentage can be effective for winning the match. Similarly, box plot of FSP show that winner player has more FSW than loser one. So, having more FSW can effect the result.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/FSP_dens-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/FSP_dens-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/FSP_dens-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For confirmatory data analysis for this research question, two paired t-test can be conduct too. As seen on the t-test result, mean of FSP.1 is changed significantly when result change. t-tests for FSP.2 and FSW.2 are like FSP.1 and FSP.2, t-test resuşts can be seen on r code file.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-sample t-test for First Serve Percentage (FSP.1):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  fsp1_P1win and fsp1_P2win
t = 3.756, df = 941, p-value = 0.0001833
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.9190557 2.9303976
sample estimates:
mean of x mean of y 
 63.23226  61.30753 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fsw1_P1win
W = 0.9498, p-value = 1.847e-11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  fsp1_P1win and fsp1_P2win
W = 127486, p-value = 4.549e-05
alternative hypothesis: true location shift is greater than 0</code></pre>
</div>
</div>
</section>
<section id="how-does-distribution-of-number-of-double-faul-dbf-and-aces-ace-change-for-different-tournaments-grouped-by-gender" class="level4">
<h4 class="anchored" data-anchor-id="how-does-distribution-of-number-of-double-faul-dbf-and-aces-ace-change-for-different-tournaments-grouped-by-gender">How does distribution of number of double faul (DBF) and aces (ACE) change for different tournaments grouped by gender?</h4>
<p>On this part, ACE variable is created by summing of ACE.1 and ACE.2. Similarly other variables are summing and total of player 1 and player 2 statistic variables are created. Aim of this research is investigating effect of different tournament on player performance. Each tournament have different surface type so this should be effect the match statistics. As seen in the boxplots, at French open tournament, players do less ace than other tounaments. Clay surface (French open surface) can lead to this, because clay surface slow down the ball. Also, in the boxplot of DBF, we can say that players do more double foul at the US and AUS open tournaments. Both tournaments has hard surfaces. Additionally, there is significant diffrence on male and female statistics for ACE, male can do more ACE than womwn according to this graph but number of sets are not same for male and female matches. Female matches are best of 3, but male matches are best of 5. So, this can be reason for that.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With analysis of variance (ANOVA) for DBF and ACE, We can see there are significant difference between tournaments and gender for 0.05 significance level.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANAVO of DBF"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
TOURNAMENT    3   1134   378.1   24.13 4.82e-15 ***
GENDER        1    310   310.0   19.78 9.72e-06 ***
Residuals   930  14572    15.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
8 observations deleted due to missingness</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANAVO of ACE"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
TOURNAMENT    3   4114    1371    24.5 2.96e-15 ***
GENDER        1  36744   36744   656.5  &lt; 2e-16 ***
Residuals   916  51265      56                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
22 observations deleted due to missingness</code></pre>
</div>
</div>
</section>
<section id="are-there-differences-in-the-net-points-attempt-npa-and-net-points-win-npw-by-players-across-different-rounds-of-the-tournament-by-result" class="level4">
<h4 class="anchored" data-anchor-id="are-there-differences-in-the-net-points-attempt-npa-and-net-points-win-npw-by-players-across-different-rounds-of-the-tournament-by-result">Are there differences in the net points attempt (NPA) and net points win (NPW) by players across different rounds of the tournament by result?</h4>
<p>NPA and NPW has right skewed distribution for each round except 7th round, but in 7th round we have 8 observation so it can mislead the interpretation of this plot for 7th round. Therefore player NPA and NPW performances are similar for all rounds except 7th.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again by using ANOVA, we can show there is significant difference or not in NPW and NPA. As seen in ANOVA, for 0.05 significance level, there is no significant difference between NPA and NPW observations of different rounds.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  GrandSlam$NPA
W = 0.92911, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  GrandSlam$NPW
W = 0.92783, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  NPA by ROUND
Kruskal-Wallis chi-squared = 10.746, df = 6, p-value = 0.09654</code></pre>
</div>
</div>
</section>
<section id="is-there-any-correlation-between-number-of-break-points-created-bpc-total-points-win-tpw-and-first-serve-win-fsw" class="level4">
<h4 class="anchored" data-anchor-id="is-there-any-correlation-between-number-of-break-points-created-bpc-total-points-win-tpw-and-first-serve-win-fsw">Is there any correlation between number of break points created (BPC), total points win (TPW) and first serve win (FSW)?</h4>
<p>As seen on bubble plot, whwn BPC increase, TPW increase because when player break the opponent player serve, match can be extend. Also number of first serve win tend to increase when TPW and BPC increase.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/EDA_5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For CDA, we can check correlations between BPC, TPW and FSW. As seen on correlation plot,</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/CDA_5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Also, checking p values of correlation test show that there is significant correlation between BPC, TPW and FSW for 0.05 significance level.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  cor_test     p_values
1  BPC_TPW 4.643419e-76
2  BPC_FSW 1.610577e-49
3  TPW_FSW 0.000000e+00</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="missing-observation-cleaning-imputation-and-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="missing-observation-cleaning-imputation-and-data-manipulation">5. Missing Observation Cleaning, Imputation and Data Manipulation</h2>
<p>Firstly, we should find NA values. As we look at the number of NA observations of variables that include NA (below), we can see there are 5338 NA values</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FNL.1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">FNL.2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACE.1</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">DBF.1</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WNR.1</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;">UFE.1</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BPC.1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPW.1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NPA.1</td>
<td style="text-align: right;">84</td>
</tr>
<tr class="even">
<td style="text-align: left;">NPW.1</td>
<td style="text-align: right;">83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TPW.1</td>
<td style="text-align: right;">312</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST1.1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST2.1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST3.1</td>
<td style="text-align: right;">321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST4.1</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST5.1</td>
<td style="text-align: right;">857</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACE.2</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">DBF.2</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WNR.2</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;">UFE.2</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BPC.2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPW.2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NPA.2</td>
<td style="text-align: right;">84</td>
</tr>
<tr class="even">
<td style="text-align: left;">NPW.2</td>
<td style="text-align: right;">83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TPW.2</td>
<td style="text-align: right;">312</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST1.2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST2.2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST3.2</td>
<td style="text-align: right;">321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST4.2</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="even">
<td style="text-align: left;">ST5.2</td>
<td style="text-align: right;">857</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For, FNL.1 and FNL.2 NA observation are because of cancelled match. At the <a href="https://www.tennisabstract.com/cgi-bin/wplayer-classic.cgi?p=AlizeCornet&amp;f=A2014qqC2">link</a>, you can see this match (date 13.01.2014) is cancelled. This row is removed from data set.</p>
<p>There is NA in ACE.1 and ACE.2 columns at same observations, this is MCAR type missing observations, we can fill this values by median value of ACE. Median of ACE.1 and ACE.2 are and .</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/NA_10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  1   2  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  1   3  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  1   4  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  1   5  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  2   1  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  2   2  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  2   3  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  2   4  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  2   5  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  3   1  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  3   2  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  3   3  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  3   4  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  3   5  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  4   1  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  4   2  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  4   3  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  4   4  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  4   5  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  5   1  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  5   2  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  5   3  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  5   4  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*
  5   5  ACE.1*  DBF.1*  NPA.1*  NPW.1*  ACE.2*  DBF.2*  NPA.2*  NPW.2*</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$ACE.1[!is.na(GrandSlam_bfIMP$ACE.1)] and GrandSlam$ACE.1
D = 0.026791, p-value = 0.9349
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$ACE.2[!is.na(GrandSlam_bfIMP$ACE.2)] and GrandSlam$ACE.2
D = 0.026723, p-value = 0.9361
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$DBF.1[!is.na(GrandSlam_bfIMP$DBF.1)] and GrandSlam$DBF.1
D = 0.0060002, p-value = 1
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$DBF.2[!is.na(GrandSlam_bfIMP$DBF.2)] and GrandSlam$DBF.2
D = 0.0079316, p-value = 1
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$NPA.1[!is.na(GrandSlam_bfIMP$NPA.1)] and GrandSlam$NPA.1
D = 0.05586, p-value = 0.1687
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$NPA.2[!is.na(GrandSlam_bfIMP$NPA.2)] and GrandSlam$NPA.2
D = 0.05586, p-value = 0.1687
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$NPW.1[!is.na(GrandSlam_bfIMP$NPW.1)] and GrandSlam$NPW.1
D = 0.054003, p-value = 0.1979
alternative hypothesis: two-sided</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  GrandSlam_bfIMP$NPW.2[!is.na(GrandSlam_bfIMP$NPW.2)] and GrandSlam$NPW.2
D = 0.053144, p-value = 0.2128
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>After missing data cleaning and imputation, we have 816 observations and 28 variables.</p>
</section>
<section id="statistical-modelling" class="level2">
<h2 class="anchored" data-anchor-id="statistical-modelling">Statistical Modelling</h2>
<section id="train-test-data-set-preparation" class="level3">
<h3 class="anchored" data-anchor-id="train-test-data-set-preparation">Train-Test Data Set Preparation</h3>
<p>GrandSlam data set splited by 20% test and 80% training by random selection. Before modelling, numeric variables in the train and test data set should be scaled. Firstly, train set is scaled and then, by using train set mean and standart deviation test set should be scaled too. Test and train sets are scaled after splitting, because, test observations should not be effect anything on the train data set in order to maintain integrity of model evaluation.</p>
</section>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h3>
<p>Logistic regression is used to predict the RESULT of the tennis matches on this project. As a cross validation method, k-fold cv is used for k equals 10. This cv is made by using “caret” package in r. Our dependent variable should be binary. So, RESULT is binary with 1 or 2.</p>
<p>Independence: predictors should be independent from each other, We can approve that by checking correlation between numeric predictors. As seen on the correlation plot. There are high correlation between NPW and NPA, BPC and BPW, FSP and SSP. So, NPW, BPW and SSP variables are removed from data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Pearson correlation coefficients</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>numeric_var <span class="ot">&lt;-</span> GrandSlam_trn_std <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(NPW<span class="fl">.1</span>,NPA<span class="fl">.1</span>,NPW<span class="fl">.2</span>,NPA<span class="fl">.2</span>,BPC<span class="fl">.1</span> ,BPW<span class="fl">.1</span>,BPC<span class="fl">.2</span> ,BPW<span class="fl">.2</span>,FSP<span class="fl">.1</span>, SSP<span class="fl">.1</span>,FSP<span class="fl">.2</span>, SSP<span class="fl">.2</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_var,<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print correlation matrix</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/corr-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std <span class="ot">&lt;-</span> GrandSlam_trn_std <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(NPW<span class="fl">.1</span>,NPW<span class="fl">.2</span>,BPW<span class="fl">.1</span>,BPW<span class="fl">.2</span>, SSP<span class="fl">.1</span>, SSP<span class="fl">.2</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std <span class="ot">&lt;-</span> GrandSlam_tst_std <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(NPW<span class="fl">.1</span>,NPW<span class="fl">.2</span>,BPW<span class="fl">.1</span>,BPW<span class="fl">.2</span>, SSP<span class="fl">.1</span>, SSP<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, logistic regression can be applied. Logistic regression find that probability of result equal to 2.</p>
<p>FSW, SSW and BPC statistics are more effective than other to predict winner. Also, p-values show that FSW, SSW and BPC are highly significant predictors. FSW and BPC influence can be seen in EDA part too. That shows that, player can practice more serve shoots to increase the win rate. Also, model indicate that breaking the opponent serve with fast shoots is really effective on win rate.</p>
<p>On the other hand, WNR and UFE seems marginally significant and can be effective to predict result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#10 k fold cv.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span> ,<span class="at">savePredictions =</span> <span class="st">"final"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">&lt;-</span> <span class="fu">train</span>(RESULT <span class="sc">~</span> ., <span class="at">data =</span> GrandSlam_trn_std, <span class="at">method =</span> <span class="st">"glm"</span>,<span class="at">family=</span>binomial,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trControl =</span> train_control)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>log_model_1<span class="ot">&lt;-</span>log_model<span class="sc">$</span>finalModel</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          -0.22320    0.57947  -0.385   0.7001    
FSP.1                -0.68261    0.54033  -1.263   0.2065    
FSW.1                -3.39320    0.56574  -5.998 2.00e-09 ***
SSW.1                -2.29155    0.50728  -4.517 6.26e-06 ***
ACE.1                -0.68040    0.42776  -1.591   0.1117    
DBF.1                 0.21371    0.36538   0.585   0.5586    
WNR.1                -0.63741    0.42201  -1.510   0.1309    
UFE.1                 0.71008    0.43441   1.635   0.1021    
BPC.1                -3.58080    0.56028  -6.391 1.65e-10 ***
NPA.1                 0.61900    0.37750   1.640   0.1011    
FSP.2                -0.33776    0.52577  -0.642   0.5206    
FSW.2                 4.08578    0.66701   6.126 9.04e-10 ***
SSW.2                 2.10407    0.47605   4.420 9.88e-06 ***
ACE.2                 0.34426    0.35544   0.969   0.3328    
DBF.2                -0.22782    0.38762  -0.588   0.5567    
WNR.2                 0.69110    0.40023   1.727   0.0842 .  
UFE.2                -0.37323    0.32758  -1.139   0.2546    
BPC.2                 2.29272    0.48770   4.701 2.59e-06 ***
NPA.2                -0.06424    0.35665  -0.180   0.8571    
ROUND2               -0.34104    0.55173  -0.618   0.5365    
ROUND3               -0.26839    0.72687  -0.369   0.7119    
ROUND4               -0.44026    0.94060  -0.468   0.6397    
ROUND5               -1.99098    1.19573  -1.665   0.0959 .  
ROUND6                0.35155    2.69868   0.130   0.8964    
ROUND7               -0.70453   19.69627  -0.036   0.9715    
TOURNAMENTFrenchOpen -0.03947    0.61571  -0.064   0.9489    
TOURNAMENTUSopen      1.73197    1.05558   1.641   0.1008    
TOURNAMENTWimbledon   0.26597    0.61486   0.433   0.6653    
GENDERM               0.06973    0.71894   0.097   0.9227    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 905.06  on 652  degrees of freedom
Residual deviance: 155.85  on 624  degrees of freedom
AIC: 213.85

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
<p>Other predictors are not significant, so we can remake the logistic regression with significant predictors.</p>
<p>Now all predictors are significant to predict RESULT. FSW is the most effective statistics to win the match. When FSW.1 change one unit, the log odds of the outcome decrease 3.11214 units. This means there is negative relationship between probability of result 2 and FSW.1. Similarly SSW.1, BPC.1, WNR.1 and UFE.2 has negative effect to result equal 2. As expected, FSW.2, SSW.2, BPC.2, WNR.2 and UFE.1 has positive relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">&lt;-</span> <span class="fu">train</span>(RESULT <span class="sc">~</span> FSW<span class="fl">.1</span><span class="sc">+</span>SSW<span class="fl">.1</span><span class="sc">+</span>BPC<span class="fl">.1</span><span class="sc">+</span>WNR<span class="fl">.1</span><span class="sc">+</span>UFE<span class="fl">.1</span><span class="sc">+</span>FSW<span class="fl">.2</span><span class="sc">+</span>SSW<span class="fl">.2</span><span class="sc">+</span>BPC<span class="fl">.2</span><span class="sc">+</span>WNR<span class="fl">.2</span><span class="sc">+</span>UFE<span class="fl">.2</span>, <span class="at">data =</span> GrandSlam_trn_std, <span class="at">method =</span> <span class="st">"glm"</span>,<span class="at">family=</span>binomial,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trControl =</span> train_control)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>log_model1<span class="ot">&lt;-</span> log_model<span class="sc">$</span>finalModel</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -0.1470     0.2272  -0.647  0.51756    
FSW.1        -3.3222     0.4456  -7.456 8.93e-14 ***
SSW.1        -1.5061     0.2746  -5.485 4.12e-08 ***
BPC.1        -3.2159     0.4142  -7.764 8.26e-15 ***
WNR.1        -0.8519     0.3250  -2.621  0.00876 ** 
UFE.1         0.6404     0.3074   2.083  0.03722 *  
FSW.2         3.6181     0.4606   7.855 4.00e-15 ***
SSW.2         2.1677     0.3389   6.397 1.59e-10 ***
BPC.2         2.2941     0.4304   5.330 9.84e-08 ***
WNR.2         0.3612     0.2918   1.238  0.21581    
UFE.2        -0.4994     0.2203  -2.267  0.02341 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 905.06  on 652  degrees of freedom
Residual deviance: 172.09  on 642  degrees of freedom
AIC: 194.09

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>You can find vif matrix of logistic regression below. There are no higher than 5 vif value. So, there is no highly correlated variables that lead multicollinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(log_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   FSW.1    SSW.1    BPC.1    WNR.1    UFE.1    FSW.2    SSW.2    BPC.2 
4.149757 1.964917 2.596581 2.456327 2.302997 4.033307 2.424501 2.571267 
   WNR.2    UFE.2 
1.746291 1.712156 </code></pre>
</div>
</div>
<p>There is confusion matrix for test data and performance statistics for test and train data.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="qmd_final_files/figure-html/log_performance-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Test data Performance of Logistic Regression</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9263804</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9305556</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9054054</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9178082</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Accuracy is 0.9263804 for test data which is acceptable and effective result. Other performance parameters show high performance as well.</p>
</section>
</section>
<section id="appendices" class="level2">
<h2 class="anchored" data-anchor-id="appendices">APPENDİCES</h2>
<section id="appendix-a" class="level3">
<h3 class="anchored" data-anchor-id="appendix-a">APPENDİX A</h3>
<table class="table">
<caption>Variable Name and Definition</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>Name of Variable</th>
<th>Definition of Variable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Player 1</td>
<td>Name of Player 1 (Nominal)</td>
</tr>
<tr class="even">
<td>Player 2</td>
<td>Name of Player 2 (Nominal)</td>
</tr>
<tr class="odd">
<td>Round</td>
<td>Round of the tourneament (Nominal Ordinal) (1: 1st elimination round, 7: Final of the tournament )</td>
</tr>
<tr class="even">
<td>Result</td>
<td>Result of the match (0/1) - Referenced on Player 1 is Result = 1 (Nominal)</td>
</tr>
<tr class="odd">
<td>FSP.1 and .2</td>
<td>First Serve Percentage for player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>FSW.1 and .2</td>
<td>First Serve Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>SSP.1 and .2</td>
<td>Second Serve Percentage for player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>SSW.1 and .2</td>
<td>Second Serve Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>ACE.1 and .2</td>
<td>Aces won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>DBF.1 and .2</td>
<td>Double Faults committed by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>WNR.1 and .2</td>
<td>Winners earned by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>UFE.1 and .2</td>
<td>Unforced Errors committed by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>BPC.1 and .2</td>
<td>Break Points Created by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>BPW.1 and .2</td>
<td>Break Points Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>NPA.1 and .2</td>
<td>Net Points Attempted by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>NPW.1 and .2</td>
<td>Net Points Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>TPW.1 and .2</td>
<td>Total Points Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>ST1.1 and .2</td>
<td>Set 1 result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>ST2.1 and .2</td>
<td>Set 2 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>ST3.1 and .2</td>
<td>Set 3 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>ST4.1 and .2</td>
<td>Set 4 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>ST5.1 and .2</td>
<td>Set 5 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>FNL.1 and .2</td>
<td>Final Number of Games Won by Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>tournament</td>
<td>Tournament name</td>
</tr>
<tr class="odd">
<td>gender</td>
<td>Tournament gender</td>
</tr>
</tbody>
</table>
</section>
<section id="appendix-b" class="level3">
<h3 class="anchored" data-anchor-id="appendix-b">APPENDİX B</h3>
<p>VIF matrix of logistic regression:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               FSP.1                FSW.1                SSW.1 
            6.157686             6.486818             6.608488 
               ACE.1                DBF.1                WNR.1 
            3.374522             1.890051             4.078776 
               UFE.1                BPC.1                NPA.1 
            4.381304             4.719309             3.550146 
               FSP.2                FSW.2                SSW.2 
            5.320796             8.334148             4.750443 
               ACE.2                DBF.2                WNR.2 
            2.205981             2.150387             3.022742 
               UFE.2                BPC.2                NPA.2 
            3.343400             2.830212             3.295335 
              ROUND2               ROUND3               ROUND4 
            1.471492             1.399042             1.311480 
              ROUND5               ROUND6               ROUND7 
            1.510631             1.039341             1.001553 
TOURNAMENTFrenchOpen     TOURNAMENTUSopen  TOURNAMENTWimbledon 
            1.821957             1.596124             1.932977 
             GENDERM 
            3.108233 </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>